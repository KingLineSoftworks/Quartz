name: Quartz Linux Unit Tests

on:
  push:
    branches:
      - "master"

jobs:
  all:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with:
          submodules: recursive
      - name: "Print user"
        run: whoami
      - name: "Print directory"
        run: pwd 
      - name: "List contents"
        run: ls -lash

  # ===========================================================================================
  # This is the variant which attempts to use ssh to get into jade for building and running
  # tests there
  #
  # This is not working because jade is not configured to accept ssh sessions from outside of
  # the local network
  # ===========================================================================================
  ssh-build-test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Validate sshpass exists
        run: sshpass -h
      - name: Setup ~/.ssh directory
        run: |
          mkdir -p ~/.ssh
          touch ~/.ssh/known_hosts
      - name: Populate known hosts file
        run: echo "${{ secrets.JADE_HOST_SIGNATURES }}" >> ~/.ssh/known_hosts
      - name: SSH With Password
        run: sshpass -e ssh -vvv -tt ${{ secrets.JADE_RUNNER_USERNAME }}@${{ secrets.JADE_IP }} "whoami ; pwd"
        env:
          SSHPASS: ${{ secrets.JADE_RUNNER_PASSWORD }}

